<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SSG-VUE3.0-听课笔记 | 云朵</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="追风赶月莫停留,平芜尽处是春山">
    
    <link rel="preload" href="/assets/css/0.styles.5ab8ebd7.css" as="style"><link rel="preload" href="/assets/js/app.dce7e1bf.js" as="script"><link rel="preload" href="/assets/js/2.c4a55d75.js" as="script"><link rel="preload" href="/assets/js/19.b50cacff.js" as="script"><link rel="prefetch" href="/assets/js/10.9cd1f2ae.js"><link rel="prefetch" href="/assets/js/11.a7f968de.js"><link rel="prefetch" href="/assets/js/12.2413d206.js"><link rel="prefetch" href="/assets/js/13.ba447224.js"><link rel="prefetch" href="/assets/js/14.89baece4.js"><link rel="prefetch" href="/assets/js/15.6ca3c8be.js"><link rel="prefetch" href="/assets/js/16.6ca7946b.js"><link rel="prefetch" href="/assets/js/17.f6f52c98.js"><link rel="prefetch" href="/assets/js/18.76b19f63.js"><link rel="prefetch" href="/assets/js/20.a06e7e52.js"><link rel="prefetch" href="/assets/js/21.e0fc57df.js"><link rel="prefetch" href="/assets/js/22.85a510e4.js"><link rel="prefetch" href="/assets/js/3.cfac0a20.js"><link rel="prefetch" href="/assets/js/4.fca4814b.js"><link rel="prefetch" href="/assets/js/5.216cae74.js"><link rel="prefetch" href="/assets/js/6.537e369f.js"><link rel="prefetch" href="/assets/js/7.ec4946c3.js"><link rel="prefetch" href="/assets/js/8.bd2e3904.js"><link rel="prefetch" href="/assets/js/9.d5a996d0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5ab8ebd7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">云朵</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/afront/base/" class="nav-link">
  起步
</a></div><div class="nav-item"><a href="/afront/pro/" class="nav-link router-link-active">
  进阶
</a></div><div class="nav-item"><a href="/afront/common/" class="nav-link">
  其他
</a></div><div class="nav-item"><a href="/aboutme/" class="nav-link">
  关于云朵
</a></div><div class="nav-item"><a href="https://github.com/hugelove" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/afront/base/" class="nav-link">
  起步
</a></div><div class="nav-item"><a href="/afront/pro/" class="nav-link router-link-active">
  进阶
</a></div><div class="nav-item"><a href="/afront/common/" class="nav-link">
  其他
</a></div><div class="nav-item"><a href="/aboutme/" class="nav-link">
  关于云朵
</a></div><div class="nav-item"><a href="https://github.com/hugelove" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/afront/base/" class="sidebar-link">起步</a></li><li><a href="/afront/pro/" aria-current="page" class="sidebar-link">进阶</a></li><li><a href="/afront/common/" class="sidebar-link">通用</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ssg-vue3-0-听课笔记"><a href="#ssg-vue3-0-听课笔记" class="header-anchor">#</a> SSG-VUE3.0-听课笔记</h1> <h2 id="不懂就问、不会就学、错了就改"><a href="#不懂就问、不会就学、错了就改" class="header-anchor">#</a> 不懂就问、不会就学、错了就改</h2> <h4 id="setup"><a href="#setup" class="header-anchor">#</a> setup</h4> <p>1，理解：Vue3.0</p> <p>2，setup是所有Composition API（组合式API）“表演的舞台”</p> <p>3，组件中所有用到的：数据，方法等等，均要配置在setup中。</p> <p>4，setup函数的两种返回值</p> <ul><li>若返回一个对象，则对象中的属性，方法，在模板中均可以直接使用。（重点关注）</li> <li>若返回一个渲染函数：则可以自定义渲染内容。（了解）</li></ul> <p>5，注意点：</p> <p>1，尽量不要与vue2.x配置混用</p> <ul><li>Vue2.x配置（data，methods,computed...）中可以访问到setup中的属性，方法。</li> <li>但在setup中不能访问到Vue2.x配置（data,methods,computed...）</li> <li>如果有重名，setup优先。</li></ul> <p>2，setup不能是一个async函数，因为返回值不再是return的对象，而是promise，模板看不到return对象中的属性。（后期也可以返回一个Promise实例，但是需要Suspense和异步组件的配合）</p> <h4 id="ref-函数"><a href="#ref-函数" class="header-anchor">#</a> ref 函数</h4> <ul><li><p>作用：定义一个响应式的数据</p></li> <li><p>语法：const xx = ref(initValue)</p> <ul><li>创建一个包含响应式数据的**<code>&lt;font color=&quot;#F00&quot;&gt;</code>引用对象（reference对象）<code>&lt;/font&gt;</code>**</li> <li>JS 中操作数据：name.value</li> <li>模板中读取数据：不需要.value，直接 <code>&lt;div&gt;</code><code>&lt;/div&gt;</code></li></ul></li> <li><p>备注：</p> <ul><li>接收的数据可以是: 基本类型，也可以是对象类型</li> <li>基本类型的数据：响应式依然靠Object.defineProperty()的get与set完成的</li> <li>对象类型的数据：内部 ** 求助 ** 了Vue3.0的一个新函数 --- reactive函数。</li></ul></li></ul> <h4 id="reactive-函数"><a href="#reactive-函数" class="header-anchor">#</a> reactive 函数</h4> <ul><li><p>作用：定义一个 <code>&lt;strong style='color:#F00'&gt;</code>对象类型 <code>&lt;/strong&gt;</code>的响应式数据(基本类型不要用它，要用ref函数)</p></li> <li><p>语法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//接收一个对象（或数组）,返回一个代理对象（Proxy的实例对象，简称Proxy对象）</span>
<span class="token keyword">const</span> 代理对象 <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span>原对象<span class="token punctuation">)</span> 
</code></pre></div></li> <li><p>reactive 定义的响应式数据是“深层次的”</p></li> <li><p>内部基于ES6的Proxy实现，通过代理对象操作源对象内部数据进行操作。</p></li></ul> <h4 id="vue3-0的响应式原理"><a href="#vue3-0的响应式原理" class="header-anchor">#</a> Vue3.0的响应式原理</h4> <div class="language- extra-class"><pre><code>#####     vue2.x的响应式原理
</code></pre></div><ul><li><p>对象类型：通过Object.defineProperty()对属性的读取，修改进行拦截（数据劫持）。</p></li> <li><p>数据类型：通过重写更新数组的一些列方法来实现拦截。（对数组的变更方法进行了包裹）</p> <div class="language- extra-class"><pre class="language-text"><code>Object.defineProperty(data,'count',{
	get(){},
	set(){}
})
</code></pre></div></li> <li><p>存在问题</p> <ul><li>新增属性，删除属性，界面不会更新。</li> <li>直接通过下标修改数组，界面不会自动更新</li></ul> <h5 id="vue3-0的响应式实现原理"><a href="#vue3-0的响应式实现原理" class="header-anchor">#</a> vue3.0的响应式实现原理</h5> <ul><li>通过Proxy(代理):拦截对象中任意的变化，包括：属性值的读写，属性的添加，属性的删除等。</li> <li>通过Reflect(反射)：对被代理对象(源对象)的属性进行操作</li></ul> <p>Proxy:</p> <p>Reflect:</p></li></ul> <h4 id="reactive-对比-ref"><a href="#reactive-对比-ref" class="header-anchor">#</a> reactive 对比 ref</h4> <ul><li>从定义数据角度对比：
<ul><li>ref用来定义：基本数据类型。</li> <li>reactive用来定义：对象（或者数组）类型。</li> <li>PS:ref也可以用来定义对象（或者数组）类型数据，它内部会自动通过reactive转为代理对象。</li></ul></li> <li>从原理角度对比:
<ul><li>ref通过Object.definePropery的get与set来实现响应式（数据劫持）。</li> <li>reactive通过使用Proxy来实现响应式（数据劫持），并通过Reflect操作源对象内部的数据。</li></ul></li> <li>从使用者角度对比：
<ul><li>ref定义的数据：操作数据需要.value，读取数据时模板中直接读取不需要.value。</li> <li>reactive定义的数据：操作数据与读取数据：均不需要.value。</li></ul></li></ul> <h4 id="setup的两个注意点"><a href="#setup的两个注意点" class="header-anchor">#</a> setup的两个注意点</h4> <ul><li>setup执行的时机：
<ul><li>在beforeCreate之前执行一次，this是undefined。</li></ul></li> <li>setup的参数：
<ul><li>props：值为对象，包含：组件外部传递过来，且组件内部声明接收了的属性。</li> <li>context: 上下文对象
<ul><li>attrs:值为对象，包含：组件外部传递过来，但没有在props配置中声明的属性，相当于this.$attrs。</li> <li>slots：收到的插槽内容，相当于this.$slots。</li> <li>emit：分发自定义事件的函数，相当于this.$emit。</li></ul></li></ul></li></ul> <h4 id="computed-函数"><a href="#computed-函数" class="header-anchor">#</a> computed 函数</h4> <p>与vue2.x中computed配置功能一致</p> <p>写法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token operator">...</span>
	<span class="token comment">//计算属性--简写</span>
	<span class="token keyword">let</span> fullName <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> person<span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> person<span class="token punctuation">.</span>lastName
 	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	<span class="token comment">//计算属性--完整写法</span>
	<span class="token keyword">let</span> fullName <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> person<span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> person<span class="token punctuation">.</span>lastName
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">const</span> nameArr <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span>
			person<span class="token punctuation">.</span>firstName <span class="token operator">=</span> nameArr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
			person<span class="token punctuation">.</span>lastName <span class="token operator">=</span> nameArr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="watch-函数"><a href="#watch-函数" class="header-anchor">#</a> watch 函数</h4> <ul><li>与vue2.x中watch配置功能一致</li> <li>两个注意点：
<ul><li>监视reactive定义的响应式数据时：oldValue无法正确获取，强制开启了深度监听（deep配置无效）</li> <li>监视reactive定义的响应式数据中某个属性时：deep配置有效。</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>		<span class="token comment">/**
		 * watch写法：{immediate:true,deep:true}都是可选
         * watch(监视的参数，监视的回调，监视的配置)
         * watch(监视的参数,(newValue,oldValue)=&gt;{
         *      // .......写的监听方法
         * },{immediate:true,deep:true})
		**/</span>
        <span class="token comment">/**
         * 1,监视ref所定义的一个响应式数据
         * **/</span>
        <span class="token function">watch</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ref定义的sum值变化了'</span><span class="token punctuation">,</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span> 

        <span class="token comment">/**
         * 2,监视ref定义的多个响应式数据
         * 2-1：ref定义的多个响应式数据的第一种写法分开写
        */</span>
       <span class="token function">watch</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ref定义的多个响应式数据的监听---sum变化了'</span><span class="token punctuation">,</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span>
       <span class="token punctuation">}</span><span class="token punctuation">)</span>
       <span class="token function">watch</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ref定义的多个响应式数据的监听---msg变化了'</span><span class="token punctuation">,</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span>
       <span class="token punctuation">}</span><span class="token punctuation">)</span> 

       <span class="token comment">/**
         * 2,监视ref定义的多个响应式数据
         * 2-2：ref定义的多个响应式数据的第二种写法合并在一起，放到一个数组里面
        */</span>
       <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span>sum<span class="token punctuation">,</span>msg<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'sum或者msg发生了变化'</span><span class="token punctuation">,</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span>
       <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token comment">/**
       * 3,监视reactive所定义的一个响应式数据的【全部数据】
       *   注意：
       *   3.1这里无法正确获取oldValue
       *   3.2针对于person.job.j1.salary没有开启deep:true也开启了深度监听
       *      deep:false 也不能关闭
       * **/</span>
      <span class="token function">watch</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'reactive定义的person发生了变化'</span><span class="token punctuation">,</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span> 

      <span class="token comment">/* 4,监视reactive多定义的一个响应式数据中某个属性
       * （比如只想监听person中的age变化）
       *
     */</span>
      <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>person<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'reactive定义的person发生了变化'</span><span class="token punctuation">,</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span> 

      <span class="token comment">/****
       * 5,监视reactive定义的一个响应式数据中的某些属性
       *  (比如想想监听person.age,person.name)
       *  相当于上面2,4结合
       *  */</span> 
    <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>person<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>person<span class="token punctuation">.</span>age<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'person的name，age变化了'</span><span class="token punctuation">,</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span> 
    <span class="token punctuation">}</span><span class="token punctuation">)</span> 

    <span class="token comment">/**
     * 6，特殊情况
     *    改的数据层次比较深，比如person.job.j1.salary 需要添加上{deep:true}
     *    这里监视的是reactive定义的对象中的某个属性（person.job），也就是说第一个参数配置的不再是reactive定义的对象‘person’了，这里的{deep:true}是要配置的，而且是有效的。
     * ** */</span> 
     <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>person<span class="token punctuation">.</span>job<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'person的job变化了'</span><span class="token punctuation">,</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">deep</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="watcheffect函数"><a href="#watcheffect函数" class="header-anchor">#</a> watchEffect函数</h4> <ul><li>watch:既要指明监视的属性，也要指明监视的回调</li> <li>watchEffect:不用指明监视哪个属性，监视的回调中用到哪个属性，那就监视哪个属性。</li> <li>watchEffect有点像computed
<ul><li>但computed注重计算出来的值（回调函数的返回值），所以必须要写返回值</li> <li>watchEffect更注重的是过程（回调函数的函数体），所以不用写返回值。</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//watchEffect所指定的回调中用到的数据只要发生变化，则直接重新执行回调。</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> x1 <span class="token operator">=</span> sum<span class="token punctuation">.</span>value
    <span class="token keyword">const</span> x2 <span class="token operator">=</span> person<span class="token punctuation">.</span>age
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'watchEffect配置的回调执行了'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h4> <ul><li>Vue3.0中可以继续使用vue2.x中的生命周期钩子，但是有两个被更名：
<ul><li><code>beforeDestroy</code> 改名为 <code>beforeUnmount</code></li> <li><code>destroyed</code> 改名为 <code>unmounted</code></li></ul></li> <li>Vue3.0也提供了Composition API（组合式API）形式的生命周期钩子,与Vue2.x中钩子相对应关系如下：
<ul><li><code>beforeCreate</code>   对 <code>setup()</code></li> <li><code>created</code>             对 <code>setup()</code></li> <li><code>beforeMount</code>     对 <code>onBeforeMount</code></li> <li><code>mounted</code>              对 <code>onMounted</code></li> <li><code>beforeUpdate</code>    对 <code>onBeforeUpdate</code></li> <li><code>updated</code>               对 <code>onUpdated</code></li> <li><code>beforeUnmount</code>   对 <code>onBeforeUnmout</code></li> <li><code>unmounted</code>           对 <code>onUnmounted</code></li></ul></li></ul> <h4 id="自定义hook函数"><a href="#自定义hook函数" class="header-anchor">#</a> 自定义hook函数</h4> <ul><li>什么是hook？ 本质是一个函数，把setup函数中使用的Composition API进行了封装</li> <li>类似于vue2.x中的mixin</li> <li>自定义hook的优势：复用代码，让setup中的逻辑更清楚易懂</li></ul> <h4 id="toref"><a href="#toref" class="header-anchor">#</a> toRef</h4> <ul><li>作用：创建一个ref对象，其value值指向另一个对象中的某个属性</li> <li>语法：<code>const name = toRef(person,'name')</code></li> <li>应用：要将响应式对象中的某个属性单独提供给外部使用时。</li> <li>扩展：toRefs与toRef功能一致，但是可以批量创建多个ref对象，语法：toRefs(person)</li></ul> <h4 id="shallowreactive-shallowref"><a href="#shallowreactive-shallowref" class="header-anchor">#</a> shallowReactive  shallowRef</h4> <ul><li>shallowReactive:只处理对象最外层属性的响应式（浅响应式）</li> <li>shallowRef:只处理基本数据类型的响应式，不进行对象的响应式处理。</li> <li>什么时候使用？
<ul><li>如果有一个对象数据，结构比较深，但是变化时只是外层属性变化 ====&gt; shallowReactive。</li> <li>如果有一个对象数据，后续功能不会修改该对象中的属性，而是生新的对象来替换 ====&gt; shallowRef</li></ul></li></ul> <h4 id="readonly-shallowreadonly"><a href="#readonly-shallowreadonly" class="header-anchor">#</a> readonly  shallowReadonly</h4> <ul><li>readonly: 让一个响应式数据变为只读的(深只读)</li> <li>shallowReadonly: 让一个响应式数据变为只读的（浅只读）</li> <li>应用场景：不希望数据被修改时</li></ul> <h4 id="toraw-markraw"><a href="#toraw-markraw" class="header-anchor">#</a> toRaw markRaw</h4> <ul><li><p>toRaw:</p> <ul><li>作用：将一个有 <code>reactive</code> 生成的响应式对象转为普通对象</li> <li>使用场景：用于读取响应式对象对应的普通对象，对这个普通对象的所有操作，不会引起页面更新。</li></ul></li> <li><p>markRaw:</p> <ul><li><p>作用：标记一个对象，使其永远不会再成为响应式对象。</p></li> <li><p>应用场景：</p> <p>1，有些值不应该被设置为响应式的，例如复杂的第三方库等。</p> <p>2，当渲染具有不可变数据源的大列表时，跳过响应式转换可以提高性能。</p></li></ul></li></ul> <h4 id="customref"><a href="#customref" class="header-anchor">#</a> customRef</h4> <ul><li>作用：创建一个自定义的ref,并对其依赖项跟踪和更新触发进行显示控制。</li> <li>实现防抖效果：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;keyWord&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> keyWord <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> customRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'App'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> keyWord <span class="token operator">=</span> <span class="token function">myRef</span><span class="token punctuation">(</span><span class="token string">'你好'</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
    <span class="token comment">// 自定义ref:myRef</span>
    <span class="token keyword">function</span> <span class="token function">myRef</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span>delay</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> timer
      <span class="token keyword">return</span> <span class="token function">customRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">track<span class="token punctuation">,</span>trigger</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">有人从myRef这个容器中读取了数据，</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
            <span class="token function">track</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//通过Vue追踪value变化（提前和get商量一下，让他知道这个value是有用的）</span>
            <span class="token keyword">return</span> value
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">有人把myRef这个容器中数据改为了</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>newValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
            <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
            timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              value <span class="token operator">=</span> newValue
              <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//通知vue去重新解析模板</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      keyWord
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h4 id="provide-inject"><a href="#provide-inject" class="header-anchor">#</a> provide  inject</h4> <ul><li><p>作用：实现祖与后代组件间通信。</p></li> <li><p>套路：父组件有一个 <code>provide</code> 选项来提供数据，子组件有一个 <code>inject</code> 选项来开始使用这些数据</p></li> <li><p>具体写法：</p> <ul><li><p>父组件中：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token operator">...</span><span class="token operator">...</span>
	<span class="token keyword">let</span> car <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'奔驰'</span><span class="token punctuation">,</span><span class="token literal-property property">price</span><span class="token operator">:</span><span class="token string">'40W'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">'car'</span><span class="token punctuation">,</span>car<span class="token punctuation">)</span>
	<span class="token operator">...</span><span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>后代组件中：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span>context</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token operator">...</span><span class="token operator">...</span>
	<span class="token keyword">const</span> car <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">'car'</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>car<span class="token punctuation">}</span>
	<span class="token operator">...</span><span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul> <h4 id="响应式数据的判断"><a href="#响应式数据的判断" class="header-anchor">#</a> 响应式数据的判断</h4> <ul><li>isRef:检查一个值是否为一个ref对象</li> <li>isReactive: 检查一个对象是否是由 <code>reactive</code> 创建的响应式代理</li> <li>isReadonly:检查一个对象是否是由 <code>readonly</code> 创建的只读代理</li> <li>isProxy: 检查一个对象是否是由 <code>reactive</code> 或者 <code>readonly</code> 方法创建的代理</li></ul> <h3 id="新的组件"><a href="#新的组件" class="header-anchor">#</a> 新的组件</h3> <h4 id="fragment"><a href="#fragment" class="header-anchor">#</a> Fragment</h4> <ul><li>在Vue2.x中，组件必须有一个根标签</li> <li>在Vue3.0中，组件可以没有根标签，内部会将多个标签包含在一个Fragment虚拟元素中。</li> <li>好处：减少标签层级，减少内存占用</li></ul> <h4 id="teleport"><a href="#teleport" class="header-anchor">#</a> Teleport</h4> <ul><li>Teleport是一种能够将我们的组件html结构移动到指定位置的技术</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Teleport</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mask<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isShow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dialog<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>标题<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>寒暄一下吧，你好，胡歌<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isShow = false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>关闭<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
   	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Teleport</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="suspense"><a href="#suspense" class="header-anchor">#</a> Suspense</h4> <ul><li><p>等待异步组件时渲染一些额外内容，让应用有更好的用户体验</p></li> <li><p>使用步骤</p> <ul><li><p>异步引入组件</p> <div class="language-vue extra-class"><pre class="language-vue"><code>import {defineAsyncComponent } from 'vue'
const child = defineAsyncComponent(() =&gt; import('./components/Child.vue'))
</code></pre></div></li> <li><p>使用Suspense包过组件，并配置好default与fallback</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Suspense</span><span class="token punctuation">&gt;</span></span>
    		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>default</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Child</span><span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>fallback</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>
                    加载中....
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Suspense</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li></ul></li></ul> <h4 id="全局api的转移"><a href="#全局api的转移" class="header-anchor">#</a> 全局API的转移</h4> <ul><li>Vue2.X有许多全局API和配置。
<ul><li>注册全局组件，注册全局指令等</li></ul></li> <li>Vue3.0中对这些API做出了调整：
<ul><li>将全局的API，即Vue.XXX调整到应用实例app上</li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.dce7e1bf.js" defer></script><script src="/assets/js/2.c4a55d75.js" defer></script><script src="/assets/js/19.b50cacff.js" defer></script>
  </body>
</html>
